<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>图片存放服务</title>
  <!-- 预加载关键资源 -->
  <link rel="preconnect" href="https://cdn.tailwindcss.com">
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  
  <!-- 延迟加载非关键资源 -->
  <script src="https://cdn.tailwindcss.com" defer></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet" media="print" onload="this.media='all'">
  
  <!-- 配置Tailwind自定义颜色和字体 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#4F46E5',
            secondary: '#10B981',
            accent: '#F59E0B',
            neutral: '#1F2937',
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
          },
        },
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .transition-custom {
        transition: all 0.3s ease;
      }
      .hover-lift {
        @apply hover:-translate-y-1 transition-all duration-300;
      }
      .shadow-custom {
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.05);
      }
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen font-sans text-neutral">
  <div class="container mx-auto px-4 py-8 max-w-6xl">
    <!-- 头部 -->
    <header class="mb-8 text-center">
      <h1 class="text-[clamp(1.8rem,5vw,3rem)] font-bold text-primary mb-3">图片存放服务</h1>
      <p class="text-gray-600 text-lg max-w-2xl mx-auto">上传图片，获取可被外部小程序引用的URL地址</p>
    </header>

    <!-- 主要内容 -->
    <main>
      <!-- 上传区域 -->
      <section class="bg-white rounded-xl p-6 shadow-custom mb-8 transform hover-lift">
        <div class="flex flex-col md:flex-row items-center gap-6">
          <div class="w-full md:w-1/2">
            <h2 class="text-xl font-semibold mb-4 text-neutral">上传图片</h2>
            <form id="uploadForm" class="space-y-4">
              <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-primary transition-custom cursor-pointer" id="dropArea">
                <input type="file" id="imageInput" accept="image/*" class="hidden" multiple>
                <i class="fa fa-cloud-upload text-5xl text-gray-400 mb-3"></i>
                <p class="text-gray-600">拖放图片到此处，或点击选择图片</p>
                <p class="text-gray-400 text-sm mt-2">支持 JPG, PNG, GIF 等常见图片格式</p>
              </div>
              <button type="submit" class="w-full bg-primary hover:bg-primary/90 text-white py-3 px-6 rounded-lg font-medium flex items-center justify-center gap-2 transition-custom shadow-md hover:shadow-lg">
                <i class="fa fa-upload"></i>
                <span>开始上传</span>
              </button>
            </form>
          </div>
          <div class="w-full md:w-1/2 bg-gray-50 p-6 rounded-lg">
            <h2 class="text-xl font-semibold mb-4 text-neutral">使用指南</h2>
            <ul class="space-y-3">
              <li class="flex items-start gap-3">
                <i class="fa fa-check-circle text-secondary mt-1"></i>
                <span>上传图片后，系统会生成唯一的URL地址</span>
              </li>
              <li class="flex items-start gap-3">
                <i class="fa fa-check-circle text-secondary mt-1"></i>
                <span>点击复制按钮获取图片URL，可用于小程序等外部应用</span>
              </li>
              <li class="flex items-start gap-3">
                <i class="fa fa-check-circle text-secondary mt-1"></i>
                <span>图片将保存在服务器上，直到被删除</span>
              </li>
              <li class="flex items-start gap-3">
                <i class="fa fa-check-circle text-secondary mt-1"></i>
                <span>通过API接口 <code class="bg-gray-200 px-2 py-1 rounded text-sm">/images/list</code> 可获取所有图片列表</span>
              </li>
            </ul>
          </div>
        </div>
      </section>

      <!-- 上传状态提示 -->
      <div id="statusMessage" class="hidden mb-6 p-4 rounded-lg transition-all duration-300"></div>

      <!-- 图片列表 -->
      <section class="mb-10">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-2xl font-bold text-neutral">已上传图片</h2>
          <button id="refreshButton" class="bg-white hover:bg-gray-100 text-neutral py-2 px-4 rounded-lg font-medium flex items-center gap-2 transition-custom shadow">
            <i class="fa fa-refresh"></i>
            <span>刷新列表</span>
          </button>
        </div>
        
        <!-- 搜索框 -->
        <div class="mb-6">
          <input type="text" id="searchInput" placeholder="搜索图片名称..." class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-custom">
        </div>

        <!-- 图片网格 -->
        <div id="imageGrid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
          <!-- 图片会动态加载到这里 -->
          <div class="col-span-full text-center py-12 text-gray-500">
            <i class="fa fa-picture-o text-5xl mb-4"></i>
            <p>暂无上传的图片</p>
          </div>
        </div>

        <!-- 分页 -->
        <div id="pagination" class="mt-8 flex justify-center hidden">
          <!-- 分页控件会动态加载 -->
        </div>
      </section>
    </main>

    <!-- 页脚 -->
    <footer class="text-center text-gray-500 py-6">
      <p>&copy; 2023 图片存放服务 - 为小程序提供稳定的图片引用服务</p>
    </footer>
  </div>

  <!-- 图片查看模态框 -->
  <div id="imageModal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center hidden">
    <div class="relative max-w-4xl w-full max-h-[90vh]">
      <button id="closeModal" class="absolute -top-12 right-0 text-white text-2xl hover:text-gray-300 transition-custom">
        <i class="fa fa-times"></i>
      </button>
      <img id="modalImage" src="" alt="预览图片" class="max-w-full max-h-[90vh] object-contain">
      <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-black/60 text-white px-4 py-2 rounded-lg">
        <span id="modalImageName"></span>
      </div>
    </div>
  </div>

  <script>
    // 配置
    const config = {
      itemsPerPage: 12,
      currentPage: 1,
      imageList: [],
      // 性能优化配置
      debounceTime: 300
    };

    // DOM元素缓存
    const elements = {
      uploadForm: document.getElementById('uploadForm'),
      imageInput: document.getElementById('imageInput'),
      dropArea: document.getElementById('dropArea'),
      statusMessage: document.getElementById('statusMessage'),
      imageGrid: document.getElementById('imageGrid'),
      refreshButton: document.getElementById('refreshButton'),
      searchInput: document.getElementById('searchInput'),
      imageModal: document.getElementById('imageModal'),
      modalImage: document.getElementById('modalImage'),
      modalImageName: document.getElementById('modalImageName'),
      closeModal: document.getElementById('closeModal'),
      pagination: document.getElementById('pagination')
    };

    // 防抖函数
    function debounce(func, wait) {
      let timeout;
      return function executedFunction(...args) {
        const later = () => {
          clearTimeout(timeout);
          func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
      };
    }

    // 图片懒加载函数
    function lazyLoadImages() {
      const lazyImages = document.querySelectorAll('.lazy-image');
      
      // 使用IntersectionObserver实现懒加载
      if ('IntersectionObserver' in window) {
        const imageObserver = new IntersectionObserver((entries, observer) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              const image = entry.target;
              image.src = image.dataset.src;
              imageObserver.unobserve(image);
            }
          });
        });
        
        lazyImages.forEach(image => {
          imageObserver.observe(image);
        });
      } else {
        // 降级方案：滚动时检查
        let lazyLoadThrottleTimeout;
        
        function lazyLoad() {
          if (lazyLoadThrottleTimeout) {
            clearTimeout(lazyLoadThrottleTimeout);
          }
          
          lazyLoadThrottleTimeout = setTimeout(() => {
            const scrollTop = window.pageYOffset;
            
            lazyImages.forEach(img => {
              if (img.dataset.src && img.offsetTop < (window.innerHeight + scrollTop)) {
                img.src = img.dataset.src;
                img.removeAttribute('data-src');
              }
            });
            
            if (lazyImages.length === 0) {
              document.removeEventListener('scroll', lazyLoad);
              window.removeEventListener('resize', lazyLoad);
              window.removeEventListener('orientationchange', lazyLoad);
            }
          }, 20);
        }
        
        document.addEventListener('scroll', lazyLoad);
        window.addEventListener('resize', lazyLoad);
        window.addEventListener('orientationchange', lazyLoad);
        
        // 初始检查
        lazyLoad();
      }
    }

    // 初始化 - 优先设置事件监听器，然后再获取数据
    document.addEventListener('DOMContentLoaded', () => {
      // 立即检查访问协议
      checkProtocol();
      setupEventListeners();
      // 使用setTimeout让页面先渲染，提高初始加载体验
      setTimeout(fetchImages, 100);
    });
    
    // 检查访问协议并显示相应提示
    function checkProtocol() {
      if (window.location.protocol === 'file:') {
        const { imageGrid, dropArea, uploadForm, refreshButton } = elements;
        
        // 禁用所有交互元素
        dropArea.classList.add('opacity-50', 'cursor-not-allowed');
        dropArea.style.pointerEvents = 'none';
        uploadForm.style.pointerEvents = 'none';
        refreshButton.disabled = true;
        refreshButton.classList.add('opacity-50', 'cursor-not-allowed');
        
        // 提前显示协议错误提示
        imageGrid.innerHTML = `
          <div class="col-span-full text-center py-12 text-gray-500">
            <i class="fa fa-exclamation-circle text-5xl mb-4 text-red-500"></i>
            <p class="text-lg font-medium mb-4">请通过服务器访问页面</p>
            <p class="mb-4">检测到您正在使用文件浏览器直接打开页面，这会导致无法连接到服务器。</p>
            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 max-w-md mx-auto text-left">
              <p class="font-medium mb-2"><i class="fa fa-info-circle text-yellow-500 mr-2"></i>正确的访问方式：</p>
              <ol class="list-decimal list-inside space-y-2 text-sm">
                <li>确保后端服务器已启动</li>
                <li>在浏览器中访问：<code class="bg-gray-200 px-2 py-1 rounded">http://localhost:3000</code></li>
              </ol>
            </div>
          </div>
        `;
      }
    }

    // 设置事件监听器
    function setupEventListeners() {
      const { uploadForm, imageInput, dropArea, refreshButton, searchInput, imageModal, closeModal } = elements;
      
      // 点击上传区域触发文件选择
      dropArea.addEventListener('click', () => imageInput.click());
      
      // 文件选择变化
      imageInput.addEventListener('change', handleFileSelect);
      
      // 拖放上传
      ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        dropArea.addEventListener(eventName, preventDefaults, false);
      });
      
      function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
      }
      
      ['dragenter', 'dragover'].forEach(eventName => {
        dropArea.addEventListener(eventName, highlight, false);
      });
      
      ['dragleave', 'drop'].forEach(eventName => {
        dropArea.addEventListener(eventName, unhighlight, false);
      });
      
      function highlight() {
        dropArea.classList.add('border-primary', 'bg-primary/5');
      }
      
      function unhighlight() {
        dropArea.classList.remove('border-primary', 'bg-primary/5');
      }
      
      dropArea.addEventListener('drop', handleDrop, false);
      
      // 表单提交
      uploadForm.addEventListener('submit', handleUpload);
      
      // 刷新按钮
      refreshButton.addEventListener('click', fetchImages);
      
      // 搜索框 - 添加防抖处理
      searchInput.addEventListener('input', debounce(filterImages, config.debounceTime));
      
      // 模态框
      closeModal.addEventListener('click', () => imageModal.classList.add('hidden'));
      imageModal.addEventListener('click', (e) => {
        if (e.target === imageModal) {
          imageModal.classList.add('hidden');
        }
      });
    }

    // 处理文件选择
    function handleFileSelect(e) {
      const files = e.target.files;
      if (files.length) {
        highlight();
        setTimeout(unhighlight, 1000);
      }
    }

    // 处理拖放
    function handleDrop(e) {
      const dt = e.dataTransfer;
      const files = dt.files;
      if (files.length) {
        imageInput.files = files;
      }
    }

    // 处理上传
    async function handleUpload(e) {
      e.preventDefault();
      const { imageInput } = elements;
      
      const file = imageInput.files[0];
      if (!file) {
        showStatus('请先选择要上传的图片', 'error');
        return;
      }

      // 检查文件类型
      const validTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp'];
      if (!validTypes.includes(file.type)) {
        showStatus('请上传有效的图片文件', 'error');
        return;
      }

      // 检查文件大小（5MB限制）
      const maxSize = 5 * 1024 * 1024;
      if (file.size > maxSize) {
        showStatus('图片大小不能超过5MB', 'error');
        return;
      }

      const formData = new FormData();
      formData.append('image', file);

      try {
        showStatus('正在上传图片...', 'info');
        
        // 添加超时处理
        const timeoutPromise = new Promise((_, reject) => 
          setTimeout(() => reject(new Error('上传超时')), 20000)
        );
        
        const uploadPromise = fetch(`${window.location.origin}/upload`, { 
          method: 'POST',
          body: formData
        });
        
        const response = await Promise.race([uploadPromise, timeoutPromise]);
        const data = await response.json();
        
        if (data.success) {
          // 先清空图片输入
          imageInput.value = '';
          
          // 延迟一小段时间再获取列表，确保服务器缓存已更新
          setTimeout(() => {
            // 尝试刷新服务器缓存（如果服务端支持）
          fetch(`${window.location.origin}/images/refresh-cache`).catch(() => {})
            .finally(() => {
              fetchImages();
            });
          }, 300);
          
          showStatus('图片上传成功', 'success');
        } else {
          showStatus(data.message || '上传失败', 'error');
        }
      } catch (error) {
        console.error('上传错误:', error);
        showStatus(`上传过程中发生错误: ${error.message}`, 'error');
      }
    }

    // 获取图片列表 - 添加加载状态和环境检测
    async function fetchImages() {
      const { imageGrid } = elements;
      
      // 检查是否通过file://协议访问页面
      if (window.location.protocol === 'file:') {
        // 协议检测已经在页面加载时完成，这里保持简单的提示
        imageGrid.innerHTML = `
          <div class="col-span-full text-center py-12 text-gray-500">
            <p>请通过 <code class="bg-gray-200 px-2 py-1 rounded">http://localhost:3000</code> 访问页面</p>
          </div>
        `;
        return;
      }
      
      // 显示加载状态
      const loadingHTML = `
        <div class="col-span-full text-center py-12 text-gray-500">
          <div class="inline-block animate-spin rounded-full h-8 w-8 border-4 border-primary border-t-transparent mb-4"></div>
          <p>加载图片中...</p>
        </div>
      `;
      
      imageGrid.innerHTML = loadingHTML;
      
      try {
        // 添加超时处理
        const timeoutPromise = new Promise((_, reject) => 
          setTimeout(() => reject(new Error('请求超时')), 10000)
        );
        
        // 使用window.location.origin确保正确的基础URL
        const baseUrl = window.location.origin;
        const fetchPromise = fetch(`${baseUrl}/images/list`);
        const response = await Promise.race([fetchPromise, timeoutPromise]);
        const data = await response.json();
        
        if (data.success) {
          config.imageList = data.images;
          renderImages();
        } else {
          showStatus('获取图片列表失败', 'error');
          imageGrid.innerHTML = `
            <div class="col-span-full text-center py-12 text-gray-500">
              <i class="fa fa-exclamation-circle text-5xl mb-4"></i>
              <p>获取图片列表失败</p>
            </div>
          `;
        }
      } catch (error) {
        console.error('获取图片列表错误:', error);
        showStatus('获取图片列表过程中发生错误', 'error');
        imageGrid.innerHTML = `
          <div class="col-span-full text-center py-12 text-gray-500">
            <i class="fa fa-exclamation-circle text-5xl mb-4"></i>
            <p>获取图片列表过程中发生错误</p>
            <p class="text-sm mt-2">${error.message}</p>
          </div>
        `;
      }
    }

    // 过滤图片
    function filterImages() {
      config.currentPage = 1;
      renderImages();
    }

    // 渲染图片列表
    function renderImages() {
      const searchTerm = searchInput.value.toLowerCase();
      const filteredImages = config.imageList.filter(img => 
        img.filename.toLowerCase().includes(searchTerm)
      );

      // 分页计算
      const totalPages = Math.ceil(filteredImages.length / config.itemsPerPage);
      const startIndex = (config.currentPage - 1) * config.itemsPerPage;
      const endIndex = startIndex + config.itemsPerPage;
      const currentImages = filteredImages.slice(startIndex, endIndex);

      // 清空网格
      imageGrid.innerHTML = '';

      if (currentImages.length === 0) {
        imageGrid.innerHTML = `
          <div class="col-span-full text-center py-12 text-gray-500">
            <i class="fa fa-picture-o text-5xl mb-4"></i>
            <p>暂无上传的图片</p>
          </div>
        `;
        pagination.classList.add('hidden');
        return;
      }

      // 使用文档片段减少DOM操作
      const fragment = document.createDocumentFragment();
      
      // 渲染图片
      currentImages.forEach(image => {
        const imageCard = document.createElement('div');
        imageCard.className = 'bg-white rounded-xl overflow-hidden shadow-custom hover-lift';
        
        // 创建骨架屏效果
        imageCard.innerHTML = `
          <div class="relative aspect-video bg-gray-100 overflow-hidden">
            <!-- 骨架屏 -->
            <div class="absolute inset-0 bg-gray-200 animate-pulse"></div>
            <!-- 懒加载图片 -->
            <img data-src="${image.url}" alt="${image.filename}" class="w-full h-full object-cover cursor-pointer opacity-0 transition-opacity duration-500 lazy-image">
            <button class="absolute top-2 right-2 bg-black/60 text-white p-2 rounded-full hover:bg-black/80 transition-custom delete-btn opacity-0 hover-lift">
              <i class="fa fa-trash"></i>
            </button>
          </div>
          <div class="p-4">
            <div class="flex items-center justify-between mb-3">
              <h3 class="font-medium truncate" title="${image.filename}">${image.filename}</h3>
              <span class="text-xs text-gray-500">${new Date().toLocaleDateString()}</span>
            </div>
            <div class="flex items-center justify-between">
              <button class="text-sm bg-primary/10 hover:bg-primary/20 text-primary py-1 px-3 rounded transition-custom copy-btn hover-lift">
                <i class="fa fa-copy mr-1"></i>复制URL
              </button>
              <a href="${image.url}" target="_blank" class="text-sm bg-secondary/10 hover:bg-secondary/20 text-secondary py-1 px-3 rounded transition-custom hover-lift">
                <i class="fa fa-external-link mr-1"></i>查看
              </a>
            </div>
          </div>
        `;
        
        fragment.appendChild(imageCard);

        // 添加点击事件
        const imgElement = imageCard.querySelector('img');
        imgElement.addEventListener('click', () => {
          openImageModal(image);
        });

        // 图片加载完成后显示
        imgElement.onload = function() {
          this.classList.remove('opacity-0');
          this.parentElement.querySelector('.animate-pulse').remove();
        };

        // 添加复制事件
        const copyBtn = imageCard.querySelector('.copy-btn');
        copyBtn.dataset.url = image.url;
        copyBtn.addEventListener('click', function() {
          copyToClipboard(this.dataset.url);
        });
      });
      
      // 一次性添加所有图片卡片到DOM
      imageGrid.appendChild(fragment);
      
      // 触发懒加载
      lazyLoadImages();

      // 渲染分页
      renderPagination(totalPages);
    }

    // 渲染分页
    function renderPagination(totalPages) {
      const { pagination } = elements;
      
      if (totalPages <= 1) {
        pagination.classList.add('hidden');
        return;
      }

      pagination.classList.remove('hidden');
      pagination.innerHTML = '';

      // 使用文档片段减少DOM操作
      const fragment = document.createDocumentFragment();
      const paginationContainer = document.createElement('div');
      paginationContainer.className = 'flex items-center space-x-2';

      // 上一页
      const prevButton = document.createElement('button');
      prevButton.className = `px-4 py-2 rounded-lg transition-custom ${config.currentPage === 1 ? 'bg-gray-200 text-gray-400 cursor-not-allowed' : 'bg-white hover:bg-gray-100 text-neutral shadow'}`;
      prevButton.innerHTML = '<i class="fa fa-chevron-left"></i>';
      if (config.currentPage > 1) {
        prevButton.addEventListener('click', () => {
          config.currentPage--;
          renderImages();
        });
      }
      paginationContainer.appendChild(prevButton);

      // 页码
      const startPage = Math.max(1, config.currentPage - 2);
      const endPage = Math.min(totalPages, startPage + 4);

      if (startPage > 1) {
        const firstPageButton = document.createElement('button');
        firstPageButton.className = 'px-4 py-2 rounded-lg bg-white hover:bg-gray-100 text-neutral shadow transition-custom';
        firstPageButton.textContent = '1';
        firstPageButton.addEventListener('click', () => {
          config.currentPage = 1;
          renderImages();
        });
        paginationContainer.appendChild(firstPageButton);

        if (startPage > 2) {
          const ellipsis = document.createElement('span');
          ellipsis.className = 'px-2 text-gray-500';
          ellipsis.textContent = '...';
          paginationContainer.appendChild(ellipsis);
        }
      }

      for (let i = startPage; i <= endPage; i++) {
        const pageButton = document.createElement('button');
        pageButton.className = `px-4 py-2 rounded-lg transition-custom ${i === config.currentPage ? 'bg-primary text-white shadow-md' : 'bg-white hover:bg-gray-100 text-neutral shadow'}`;
        pageButton.textContent = i;
        pageButton.addEventListener('click', () => {
          config.currentPage = i;
          renderImages();
        });
        fragment.appendChild(pageButton);
      }

      if (endPage < totalPages) {
        if (endPage < totalPages - 1) {
          const ellipsis = document.createElement('span');
          ellipsis.className = 'px-2 text-gray-500';
          ellipsis.textContent = '...';
          fragment.appendChild(ellipsis);
        }

        const lastPageButton = document.createElement('button');
        lastPageButton.className = 'px-4 py-2 rounded-lg bg-white hover:bg-gray-100 text-neutral shadow transition-custom';
        lastPageButton.textContent = totalPages;
        lastPageButton.addEventListener('click', () => {
          config.currentPage = totalPages;
          renderImages();
        });
        fragment.appendChild(lastPageButton);
      }

      // 下一页
      const nextButton = document.createElement('button');
      nextButton.className = `px-4 py-2 rounded-lg transition-custom ${config.currentPage === totalPages ? 'bg-gray-200 text-gray-400 cursor-not-allowed' : 'bg-white hover:bg-gray-100 text-neutral shadow'}`;
      nextButton.innerHTML = '<i class="fa fa-chevron-right"></i>';
      if (config.currentPage < totalPages) {
        nextButton.addEventListener('click', () => {
          config.currentPage++;
          renderImages();
        });
      }
      fragment.appendChild(nextButton);

      paginationContainer.appendChild(fragment);
      pagination.appendChild(paginationContainer);
    }

    // 打开图片模态框
    function openImageModal(image) {
      const { modalImage, modalImageName, imageModal } = elements;
      modalImage.src = image.url;
      modalImageName.textContent = image.filename;
      imageModal.classList.remove('hidden');
    }

    // 复制到剪贴板
    function copyToClipboard(text) {
      navigator.clipboard.writeText(text).then(() => {
        showStatus('URL已复制到剪贴板', 'success');
      }).catch(err => {
        console.error('复制失败:', err);
        showStatus('复制失败，请手动复制', 'error');
      });
    }

    // 显示状态消息
    function showStatus(message, type = 'info') {
      const { statusMessage } = elements;
      statusMessage.textContent = message;
      statusMessage.className = 'mb-6 p-4 rounded-lg transition-all duration-300';
      
      // 设置样式
      switch (type) {
        case 'success':
          statusMessage.classList.add('bg-green-100', 'text-green-800', 'border', 'border-green-200');
          break;
        case 'error':
          statusMessage.classList.add('bg-red-100', 'text-red-800', 'border', 'border-red-200');
          break;
        case 'warning':
          statusMessage.classList.add('bg-yellow-100', 'text-yellow-800', 'border', 'border-yellow-200');
          break;
        default:
          statusMessage.classList.add('bg-blue-100', 'text-blue-800', 'border', 'border-blue-200');
      }
      
      statusMessage.classList.remove('hidden');
      
      // 3秒后自动隐藏
      setTimeout(() => {
        statusMessage.classList.add('opacity-0');
        setTimeout(() => {
          statusMessage.classList.add('hidden');
          statusMessage.classList.remove('opacity-0');
        }, 300);
      }, 3000);
    }
  </script>
</body>
</html>